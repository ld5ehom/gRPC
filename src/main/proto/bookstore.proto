syntax = "proto3";

import "google/protobuf/timestamp.proto";

/*
* Defines core domain messages and gRPC services for a bookstore system.
* 서점 시스템을 위한 핵심 도메인 메시지와 gRPC 서비스를 정의
*/
package bookstore;

/*
 Represents a book entity with publication metadata.
 책의 기본 정보와 출판 메타데이터를 표현하는 메시지
*/
message Book {

  // Unique identifier of the book.
  int64 id = 1;

  // Title of the book.
  string title = 2;

  // Publisher of the book.
  string publisher = 3;

  // Publication date of the book.
  google.protobuf.Timestamp published_date = 4;
}

// Represents an author entity.
message Author {

  // Unique identifier of the author.
  int64 id = 1;

  // Name of the author.
  string name = 2;
}

/*
Represents a review associated with a book.
특정 책에 대한 리뷰 정보를 표현하는 메시지
*/
message Review {

  // Unique identifier of the review.
  int64 id = 1;

  // Identifier of the book being reviewed.
  int64 book_id = 2;

  // Text content of the review.
  string content = 3;

  // Rating score given in the review.
  float rating = 4;

  // Creation timestamp of the review.
  google.protobuf.Timestamp created_date = 5;
}

/*
Provides RPC operations related to book management.
책 관리와 관련된 RPC 기능 제공 API
 */
service BookService {

  // Adds a new book and returns the created book.
  // 새로운 책을 추가하고 생성된 책 정보 반환
  rpc AddBook(AddBookRequest) returns (Book) {}

  // Retrieves detailed information of a specific book.
  // 특정 책의 상세 정보 조회
  rpc GetBookDetails(GetBookDetailsRequest) returns (Book) {}

  // Streams all available books.
  // 전체 책 목록을 스트리밍 방식으로 조회
  rpc ListBooks(ListBooksRequest) returns (stream Book) {}

  // Streams books written by a specific author.
  // 특정 저자가 작성한 책 목록을 스트리밍 방식으로 조회
  rpc SearchBooksByAuthor(SearchBooksByAuthorRequest) returns (stream Book) {}
}

/*
 * Provides RPC operations related to book reviews.
 * 책 리뷰와 관련된 RPC 기능 제공
 */
service ReviewService {

  // Streams reviews for a specific book.
  // 특정 책에 대한 리뷰 목록을 스트리밍 방식으로 조회
  rpc GetReviews(GetReviewsRequest) returns (stream Review) {}
}

/*
 * Request message for retrieving reviews of a book.
 * 특정 책의 리뷰 조회 요청 메시지
 */
message GetReviewsRequest {

  // Identifier of the book whose reviews are requested.
  // 리뷰를 조회할 책의 ID
  int64 book_id = 1;
}

/* Request message for adding a new book.
 * 새로운 책 추가 요청 메시지
 */
message AddBookRequest {

  // Title of the book to be added. (추가할 책의 제목)
  string title = 1;

  // Publisher of the book to be added. (추가할 책의 출판사)
  string publisher = 2;

  // Publication date of the book to be added. (추가할 책의 출판 일자)
  google.protobuf.Timestamp published_date = 3;
}

// Request message for retrieving a specific book.
// 특정 책 조회 요청 메시지
message GetBookDetailsRequest {

  // Identifier of the book to retrieve. (조회할 책의 ID)
  int64 book_id = 1;
}

// Request message for searching books by author.
// 저자 기준 책 검색 요청 메시지
message SearchBooksByAuthorRequest {

  // Name of the author used as search criteria. (검색 기준 저자 이름)
  string author_name = 1;
}

// Request message for listing all books.
// 전체 책 목록 조회 요청 메시지
message ListBooksRequest {}
